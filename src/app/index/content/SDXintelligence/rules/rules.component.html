<app-common [showLoader]="showLoader">
</app-common>
<div class="content-page">
   <div class="content">
      <div class="container">
         <div class="row">
            <div class="col-sm-12">
               <div class="page-header-title">
                  <h4 class="pull-left page-title">{{buttonName}} Rule</h4>
                  <!--<ol class="breadcrumb pull-right">
                          <li><a href="pages_index.html">Dashboard</a></li>
                          <li class="active">Users</li>
                          <li class="active">Create New Customer</li>
                          </ol>-->
                  <div class="clearfix"><a routerLink="/index/sdxintelligence/rules" data-toggle="tooltip" title=" Manage Rule" class="pull-right icon-create ng-star-inserted">
                     <i class="ti ti-layout-media-left	createnew"></i> 
                  </a></div>
               </div>
            </div>
         </div>
         <div class="row">
            <div class="col-sm-12">
               <div class="panel panel-primary">
                  <div class="panel-body">
                     <div class="col-lg-12 col-xlg-12 col-md-12">
                        <!-- <div class="row ">
                           <a routerLink="/index/sdxintelligence/rules" class="btn btn-success pull-right">
                              Manage Rule
                           </a>
                        </div> -->
                        <form class="form-horizontal" [formGroup]="ruleForm">
                           <div class="row">
                              <div class="col-md-12">
                                 <div class="form-group required">
                                    <label class="control-label">
                                       Rule Name
                                    </label>
                                    <div class="input-group">
                                       <span class="input-group-addon"><i class="ion ion-android-list"
                                             aria-hidden="true"></i></span>
                                       <input aria-describedby="addon-right addon-left" formControlName="ruleName"
                                          type="text" placeholder="Enter Rule Name" class="form-control">
                                    </div>
                                    <div *ngIf="submitted && f.ruleName.errors" class="invalid-feedback">
                                       <div *ngIf="f.ruleName.errors.required">Rule Name
                                          is required</div>
                                    </div>
                                 </div>
                              </div>
							   <!-- <div class="col-md-4">
                                            <div class="form-group required">
                                                <label class="control-label">
                                                    Status
                                                </label>
                                                <div class="input-group">
                                                    <span class="input-group-addon"><i class=" ti ti-bar-chart"
                                                            aria-hidden="true"></i></span>
                                                    <select class="form-control form-control-line"
                                                        formControlName="active">
                                                        <option value="true">Active</option>
                                                        <option value="false">In Active</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div> -->
                              <div class="col-md-6">
                                 <div class="form-group required">
                                    <label class="control-label ">
                                       Application
                                    </label>
                                    <div class="input-group">
                                       <span class="input-group-addon"><i class="ti ti-pencil-alt"
                                             aria-hidden="true"></i></span>
                                       <select class="form-control form-control-line"
                                          (change)="onChangeApplication($event.target.value)"
                                          formControlName="applicationId">
                                          <option value="" disabled>--Select--</option>
                                          <option value="{{item.applicationId}}" *ngFor="let item of applications">
                                             {{item.applicationName}}</option>
                                       </select>
                                    </div>
                                    <div *ngIf="submitted && f.applicationId.errors" class="invalid-feedback">
                                       <div *ngIf="f.applicationId.errors.required">Application Name
                                          is required</div>
                                    </div>
                                 </div>
                              </div>
                              <div class="col-md-6">
                                 <div class="form-group required">
                                    <label class="control-label ">
                                       Event Name
                                    </label>
                                    <div class="input-group">
                                       <span class="input-group-addon"><i class=" ion ion-android-calendar"
                                             aria-hidden="true"></i></span>
                                       <select class="form-control form-control-line" formControlName="eventId"
                                          (change)="onChangeEvent($event.target.value)">
                                          <option value="" disabled>--Select--</option>
                                          <option value="{{item.eventId}}" *ngFor="let item of events">
                                             {{item.eventName}}</option>
                                       </select>
                                    </div>
                                    <div *ngIf="submitted && f.eventId.errors" class="invalid-feedback">
                                       <div *ngIf="f.eventId.errors.required">Event Name
                                          is required</div>
                                    </div>
                                 </div>
                              </div>
                              <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 p-t-10">
                                 <table id="myTable" class=" table order-list">
                                    <thead>
                                       <tr>
                                          <td></td>
                                          <td>Type</td>
                                          <td>Variable</td>
                                          <td>Expression</td>
                                          <td>Value</td>
                                          <td>Condition</td>
                                          <td></td>
                                       </tr>
                                    </thead>
                                    <tbody *ngFor="let container of containers">
                                       <tr>
                                          <td class="col-sm-1"><a class="deleteRow"></a>
                                             <button type="button " id=""
                                                class="btn btn-danger1 waves-effect waves-light "
                                                (click)="removeContainer()" *ngIf="containers.length == container">
                                                <i class="ti ti-minus" aria-hidden="true"></i></button>
                                          </td>
                                          <td class="col-sm-2">
                                             <select class="form-control form-control-line" id="type{{container}}"
                                                (change)="onChangeType($event.target.value,$event.target.id)">
                                                <option value="" disabled>--Select--</option>
                                                <option value="asset">Asset</option>
                                                <option value="event">Event</option>
                                             </select>
                                          </td>
                                          <td class="col-sm-2">
                                             <select class="form-control form-control-line" (change)="onChangeCondition($event.target.value,
                                             $event.target.id)" id="variable{{container}}">
                                                <option value="" disabled>--Select--</option>
                                                <!--  <option *ngFor="let variable of variables;"
                                                            value="{{variable.variableId}}">
                                                            {{variable.variableName}}</option>  -->
                                                <!--  <option value="temprature">Temprature</option>
                                                            <option value="pressure">Pressure</option>
                                                            <option value="volume">Volume</option> -->
                                             </select>
                                          </td>
                                          <td class="col-sm-3">
                                             <select class="form-control form-control-line" (change)="onChangeCondition($event.target.value,
                                             $event.target.id)" id="operator{{container}}">
                                                <option value="" disabled>--Select--</option>
                                                <option value=">">Greater Than (>)</option>
                                                <option value="<">Less Than (<)</option> <option value="==">Equal (=)
                                                </option>
                                                <option value="!=">Not Equal (!=)</option>
                                                <option value=">=">Greater Than or Equal (>=)</option>
                                                <option value="<=">Less Than or Equal (<=)</option> </select> </td> <td
                                                      class="col-sm-2">
                                                      <input id="value{{container}}" (keyup)="onChangeCondition($event.target.value,
                                                      $event.target.id)"
                                                         aria-describedby="addon-right addon-left" type="text"
                                                         placeholder="Enter Value" class="form-control">
                                          </td>
                                          <td class="col-sm-2"><a class="deleteRow"></a>
                                             <select class="form-control form-control-line" (change)="onChangeCondition($event.target.value,
                                             $event.target.id)" id="condition{{container}}">
                                                <option value="">--Select--</option>
                                                <option value="AND">AND</option>
                                                <option value="OR">OR</option>
                                             </select>
                                          </td>
                                          <td class="col-sm-1"><a class="deleteRow"></a>
                                             <button type="button " id=""
                                                class="btn btn-primary1 waves-effect waves-light "
                                                (click)="addContainer()" *ngIf="containers.length == container">
                                                <i class="ti ti-plus" aria-hidden="true"></i></button>
                                          </td>
                                       </tr>
                                    </tbody>
                                 </table>
                              </div>
                              <div *ngIf="queryError" class="invalid-feedback">
                                 <div *ngIf="queryError">Kindly fill all the fields</div>
                              </div>
                              <div class="text-right col-sm-12">
                                 <button type="button " class="btn btn-primary" (click)="generateExpression()">Generate
                                    Query</button>&nbsp;
                              </div>

                              <div class="col-md-12">
                                 <div class="form-group required">
                                    <label class="control-label">
                                       Query
                                    </label>
                                    <div class="input-group">
                                       <span class="input-group-addon"><i class="ti ti-list"
                                             aria-hidden="true"></i></span>
                                       <textarea class="form-control" id="" formControlName="ruleExpression" rows="3"
                                          value="{{expression}}"
                                          placeholder="Query will be Auto populated based on the above selection of Asset and Variable"
                                          disabled></textarea>
                                    </div>
                                    <div *ngIf="submitted && expression == ''" class="invalid-feedback">
                                       <div *ngIf="expression == ''">Query is required</div>
                                    </div>
                                 </div>
                              </div>
                              <div class="col-md-12">
                                 <div class="form-group ">
                                    <label class="control-label">
                                       Messages
                                    </label>
                                    <div class="input-group">
                                       <span class="input-group-addon"><i class="ti ti-list"
                                             aria-hidden="true"></i></span>
                                       <textarea class="form-control" id="" formControlName="messageContent" rows="3"
                                          placeholder="Message has to be mentioned in this box(SMS & Email) Eg: ${event.eventName} has occurred"></textarea>
                                    </div>
                                 </div>
                              </div>
                           </div>
                           <div class="row ">
                              <div class="col-sm-12">
                                 <span class="manadory text-left "><small style="color:red;font-size:15px; ">*</small> -
                                    Required field </span>
                              </div>
                              <div class="text-right col-sm-12">
                                 <button type="button " class="btn btn-primary waves-effect waves-light "
                                    (click)="onSubmit()">{{buttonName}}</button>&nbsp;
                                 <button type="button " class="btn btn-default waves-effect waves-light " (click)="clear()">Reset</button>
                              </div>
                           </div>
                        </form>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </div>
</div>
<router-outlet></router-outlet>
